version: 1
frontend:
  phases:
    preBuild:
      commands:
        - echo "=== [PreBuild] Installing dependencies ==="
        - npm install
    build:
      commands:
        - echo "=== [Build] Running build script ==="
        - npm run build
    test:
      commands:
        - echo "=== [Test] Starting tests ==="
        - echo "Node version: $(node -v)"
        - echo "NPM version: $(npm -v)"
        - echo "--- Running unit tests (Jest) ---"
        - npm test -- --watchAll=false --verbose || echo "Tests completed with non-zero exit code"
        - echo "--- Simulated test case ---"
        - echo "Test: Should return 200 for homepage route"
        - 'curl -s -o /dev/null -w "%{http_code}" http://localhost:3000 || echo "Curl test skipped (dev server not running)"'
        - echo "=== [Test] Finished test phase ==="
  artifacts:
    baseDirectory: build
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
